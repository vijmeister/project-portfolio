Adapted from https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html
